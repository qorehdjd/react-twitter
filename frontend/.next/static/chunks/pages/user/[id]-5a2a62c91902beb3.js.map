{"version":3,"file":"static/chunks/pages/user/[id]-5a2a62c91902beb3.js","mappings":"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","sources":["webpack://_N_E/./components/PostForm.js","webpack://_N_E/./pages/user/[id].js","webpack://_N_E/?5a93","webpack://_N_E/<anon>"],"sourcesContent":["import React, {\r\n  useCallback, useEffect, useRef,\r\n} from 'react';\r\nimport { Form, Button, Input } from 'antd';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { ADD_POST_REQUEST, REMOVE_IMAGE, UPLOAD_IMAGES_REQUEST } from '../reducers/post';\r\nimport useInput from '../hooks/useInput';\r\n\r\nfunction PostForm() {\r\n  const { imagePaths, addPostDone } = useSelector((state) => state.post);\r\n  const dispatch = useDispatch();\r\n  const [text, onChangeText, setText] = useInput('');\r\n\r\n  useEffect(() => {\r\n    if (addPostDone) setText('');\r\n  }, [addPostDone]);\r\n\r\n  const onSubmit = useCallback(() => {\r\n    if (!text || !text.trim()) {\r\n      return alert('게시글을 작성하세요.');\r\n    }\r\n    const formData = new FormData(); // 이미지가 있을 경우 formdata로 보내야된다.\r\n    imagePaths.forEach((p) => {\r\n      formData.append('image', p);\r\n    });\r\n    formData.append('content', text);\r\n    dispatch({\r\n      type: ADD_POST_REQUEST,\r\n      data: formData,\r\n    });\r\n  }, [text, imagePaths]);\r\n\r\n  const imageInput = useRef();\r\n  const onClickImageUpload = useCallback(() => {\r\n    imageInput.current.click();\r\n  }, [imageInput.current]);\r\n\r\n  const onChangeImages = useCallback((e) => {\r\n    const imageFormData = new FormData(); // multipart/form-data 형식으로 보냄\r\n    [].forEach.call(e.target.files, (f) => { // e.target.files가 유사배열이라 배열로 바꾼다.\r\n      imageFormData.append('image', f);\r\n    });\r\n    dispatch({\r\n      type: UPLOAD_IMAGES_REQUEST,\r\n      data: imageFormData,\r\n    });\r\n  }, []);\r\n\r\n  const onRemoveImage = useCallback((imagePath) => () => {\r\n    dispatch({\r\n      type: REMOVE_IMAGE,\r\n      data: { imagePath },\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <Form\r\n      style={{ margin: '10px 0 20px' }}\r\n      encType=\"multipart/form-data\"\r\n      onFinish={onSubmit}\r\n    >\r\n      <Input.TextArea\r\n        value={text}\r\n        onChange={onChangeText}\r\n        maxLength={140}\r\n        placeholder=\"어떤 신기한 일이 있었나요?\"\r\n      />\r\n      <div>\r\n        <input type=\"file\" name=\"image\" multiple hidden ref={imageInput} onChange={onChangeImages} />\r\n        <Button onClick={onClickImageUpload}>이미지 업로드</Button>\r\n        <Button type=\"primary\" style={{ float: 'right' }} htmlType=\"submit\">\r\n          쨱짹\r\n        </Button>\r\n      </div>\r\n      <div>\r\n        {imagePaths?.map((v) => (\r\n          <div key={v} style={{ display: 'inline-block' }}>\r\n            <img src={v.replace(/\\/thumb\\//, '/original/')} style={{ width: '200px' }} alt={v} />\r\n            <div>\r\n              <Button onClick={onRemoveImage(v)}>제거</Button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default PostForm;\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { END } from 'redux-saga';\r\nimport axios from 'axios';\r\n\r\nimport { useRouter } from 'next/router';\r\nimport Head from 'next/head';\r\nimport AppLayout from '../../components/Layout/AppLayout';\r\nimport PostCard from '../../components/PostCard';\r\nimport PostForm from '../../components/PostForm';\r\nimport { LOAD_USER_POSTS_REQUEST } from '../../reducers/post';\r\nimport { LOAD_MY_INFO_REQUEST, LOAD_USER_INFO_REQUEST } from '../../reducers/user';\r\nimport wrapper from '../../store/configureStore';\r\n\r\nfunction User() {\r\n  const router = useRouter();\r\n  const { id } = router.query;\r\n\r\n  const dispatch = useDispatch();\r\n  const didMount = useRef(false);\r\n  const { me } = useSelector((state) => state.user);\r\n  const { userPosts, hasMorePost, loadUserPostsLoading, retweetError } = useSelector((state) => state.post);\r\n  const { userInfo } = useSelector((state) => state.user);\r\n\r\n  useEffect(() => {\r\n    if (didMount.current) {\r\n      if (retweetError) alert(retweetError);\r\n    } else {\r\n      didMount.current = true;\r\n    }\r\n  }, [retweetError]);\r\n\r\n  useEffect(() => {\r\n    function infiniteScroll() {\r\n      if (!hasMorePost) return window.removeEventListener('scroll', infiniteScroll);\r\n      if (loadUserPostsLoading) return;\r\n      if (window.scrollY + document.documentElement.clientHeight + 500 > document.documentElement.scrollHeight) {\r\n        const lastId = userPosts[userPosts.length - 1]?.id;\r\n        dispatch({\r\n          type: LOAD_USER_POSTS_REQUEST,\r\n          data: { userId: id, lastId },\r\n        });\r\n      }\r\n    }\r\n    window.addEventListener('scroll', infiniteScroll);\r\n    return () => window.removeEventListener('scroll', infiniteScroll);\r\n  }, [hasMorePost, loadUserPostsLoading, userPosts, id]);\r\n\r\n  return (\r\n    <AppLayout>\r\n      {userInfo && (\r\n      <Head>\r\n        <title>{userInfo.nickname}님의 글</title>\r\n        <meta name=\"description\" content={`${userInfo.nickname}님의 게시글`} />\r\n        <meta property=\"og:title\" content={`${userInfo.nickname}님의 게시글`} />\r\n        <meta property=\"og:description\" content={`${userInfo.nickname}님의 게시글`} />\r\n        <meta property=\"og:image\" content=\"https://nodebird.com/favicon.ico\" />\r\n        <meta property=\"og:url\" content={`https://nodebird.com/user/${id}`} />\r\n      </Head>\r\n      )}\r\n      {me && <PostForm />}\r\n      {userPosts.map((post) => (\r\n        <PostCard key={post.id} post={post} />\r\n      ))}\r\n    </AppLayout>\r\n  );\r\n}\r\n\r\nexport const getServerSideProps = wrapper.getServerSideProps(async (context) => {\r\n  const { cookie } = context.req.headers;\r\n  axios.defaults.headers.Cookie = '';\r\n  if (cookie) {\r\n    axios.defaults.headers.Cookie = cookie;\r\n  }\r\n  context.store.dispatch({\r\n    type: LOAD_MY_INFO_REQUEST,\r\n  });\r\n  context.store.dispatch({\r\n    type: LOAD_USER_POSTS_REQUEST,\r\n    data: { userId: context.params.id },\r\n  });\r\n  context.store.dispatch({\r\n    type: LOAD_USER_INFO_REQUEST,\r\n    data: { userId: context.params.id },\r\n  });\r\n  context.store.dispatch(END);\r\n  await context.store.sagaTask.toPromise();\r\n});\r\n\r\nexport default User;\r\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/user/[id]\",\n      function () {\n        return require(\"private-next-pages/user/[id].js\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/user/[id]\"])\n      });\n    }\n  "],"names":["__webpack_exports__","_useSelector","useSelector","state","post","imagePaths","addPostDone","dispatch","useDispatch","_useInput","useInput","_useInput2","C_Users_U_S_E_R_Desktop_prepare_react_twitter_frontend_node_modules_next_dist_compiled_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_5__","Z","text","onChangeText","setText","useEffect","onSubmit","useCallback","trim","alert","formData","FormData","forEach","p","append","type","ADD_POST_REQUEST","data","imageInput","useRef","onClickImageUpload","current","click","onChangeImages","e","imageFormData","call","target","files","f","UPLOAD_IMAGES_REQUEST","onRemoveImage","imagePath","REMOVE_IMAGE","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__","jsxs","antd__WEBPACK_IMPORTED_MODULE_6__","style","margin","encType","onFinish","children","jsx","antd__WEBPACK_IMPORTED_MODULE_7__","TextArea","value","onChange","maxLength","placeholder","name","multiple","hidden","ref","antd__WEBPACK_IMPORTED_MODULE_8__","onClick","htmlType","map","v","display","src","replace","width","alt","id","router","useRouter","query","didMount","me","user","_useSelector2","userPosts","hasMorePost","loadUserPostsLoading","retweetError","userInfo","_useSelector3","infiniteScroll","window","removeEventListener","scrollY","document","documentElement","clientHeight","scrollHeight","_userPosts","lastId","length","LOAD_USER_POSTS_REQUEST","userId","addEventListener","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__","_components_Layout_AppLayout__WEBPACK_IMPORTED_MODULE_4__","next_head__WEBPACK_IMPORTED_MODULE_3___default","nickname","content","concat","property","_components_PostForm__WEBPACK_IMPORTED_MODULE_6__","_components_PostCard__WEBPACK_IMPORTED_MODULE_5__","__NEXT_P","push","__webpack_require__"],"sourceRoot":""}